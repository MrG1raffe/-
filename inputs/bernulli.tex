\documentclass[../TV&MS.tex]{subfiles}
\begin{document}
    
\section{Испытания Бернулли}

\begin{Def}
Дискретная случайная величина $\xi$ имеет \underline{распределение Бернулли}, если
$$ \Pro(\xi = x_1) = p,\ \Pro(\xi = x_2) = q = 1 - p, \quad x_1 \not= x_2$$
\end{Def}

\begin{Def}
\underline{Схема Бернулли} --- последовательность испытаний, удовлетворяющих следующим условиям:
\begin{enumerate}
	\item Дихотомичность --- у каждого испытания два исхода, называемые <<успехом>> и <<неудачей>> или, сокращенно У/Н.
	\item Независимость --- результаты испытаний являются независимыми событиями.
	\item Однородность --- вероятности успеха в каждом испытании равны.
\end{enumerate}
\end{Def}

Из определения следует, что одно испытание имеет распределение Бернулли. Элементарным исходом в схеме Бернулли из $n$ испытаний будет являться
$$\omega = (x_1, x_2, \ldots, x_n),$$
где $x_i$ --- результат испытания $i$. Пусть в элементарном исходе $k$ успехов. Тогда
$$\Pro(\omega) = p^kq^{n-k}$$

Покажем, что веорятность, введенная таким образом, удовлетворяет всем аксиомам вероятностной меры. Неочевидной здесь является только проверка нормировки, то есть надо доказать, что
$$ \sum\limits_{\omega}\Pro(\omega) = 1$$
Для этого просуммируем все исходы по числу успехов (обозначим $\mu_n$).
$$ \sum\limits_{\omega}\Pro(\omega) = \sum\limits_{k = 0}^n\sum\limits_{\omega\colon\mu_n=k}\Pro(\omega) = \sum\limits_{k = 0}^n\sum\limits_{\omega\colon\mu_n=k}p^kq^{n-k} = 
\sum\limits_{k = 0}^nC_n^kp^kq^{n-k} = (p+q)^n = 1$$

Рассмотрим теперь некоторые важные распределения, связанные со схемой Бернулли.

Уже рассмотренная величина $\mu_n$, равная числу успехов в $n$ испытаниях Бернулли, является случайной величиной с распределением
$$\forall k \in \Int_+ \quad \Pro(\mu_n=k) = C_n^kp^kq^{n-k}$$
Это следует из того, что исходов с $k$ успехами ровно $C_n^k$, а вероятность каждого равна $p^kq^{n-k}$.
Такое распределение называется \underline{биномиальным} и обозначается $B(n,p)$.

Рассимотрим случайные величины $X_i = \Ind(A_i)б \quad i = 1, \ldots, n$, где $A_i$ --- успех в $i$-м испытании. Каждая такая величина имеет распределение Бернулли.
Тогда число успехов можно представить так:
$$\mu_n = \sum\limits_{i=1}^nX_i$$

Найдем матожидание и дисперсию $\mu_n$.
$$\Expec\mu_n = \Expec\sum\limits_{i=1}^nX_i = \sum\limits_{i=1}^n\Expec X_i = \sum\limits_{i=1}^n(1p + 0 q) = np$$
$$\Expec X_i^2 = 1p+0q = p$$
$$\Disp X_i = \Expec X_i^2 - (\Expec X_i)^2 = p - p^2 = pq$$
В силу независимости испытаний дисперсия линейна относительно сложения
$$\Disp \mu_n = \Disp\sum\limits_{i=1}^n  X_i  =\sum\limits_{i=1}^n  \Disp X_i = \sum\limits_{i=1}^n pq = npq$$

\begin{Th} [Бернулли]
Для случайной величины с распределением $B(n,p)$
$$\Pro(|\frac{\mu_n}{n} - p| \ge \epsilon) \le \frac{npq}{n^2\epsilon^2}$$
\end{Th}
\begin{Proof} \\
Домножим обе части неравенства на $n$ и воспользуемся неравенством Чебышева:
$$\Pro(|\mu_n - pn| \ge n\epsilon) \le \frac{\Disp(\mu_n)}{(n\epsilon)^2} = \frac{npq}{n^2\epsilon^2}$$
\end{Proof}

Пусть $f(x) \in C[0, 1]$.
\begin{Def}
\underline{Многочленом Бернштейна} называется функция 
$$ B_n(x, f) = \Sum{k}{0}{n}C_n^kx^k(1-x)^{n-k}f(\frac{k}{n}), \quad x \in [0, 1]$$
\end{Def}
Заметим, что $B_n(x, f) = \Expec f(\frac{\mu_n}n),\quad  \mu_n \sim B(n, x)$. (запись $\xi \sim$ *destrname*  означает, что случайная величина $\xi$ имеет распределение *destrname*).

\begin{St}
$$B_n(x, f) \rightrightarrows f(x), \quad x \in [0,1]$$
\end{St}
\begin{Proof} \\
Пользуясь тем, что $\sum\limits_{k = 0}^nC_n^kx^k(1-x)^{n-k} = 1$ получим
$$|B_n(x, f) - f(x)| = |\sum\limits_{k = 0}^nC_n^kx^k(1-x)^{n-k}f(\frac{k}n) - \sum\limits_{k = 0}^nC_n^kx^k(1-x)^{n-k}f(x)| \le 
\sum\limits_{k = 0}^nC_n^kx^k(1-x)^{n-k}|f(\frac{k}n) - f(x)|$$
Разобьем данную сумму на две:
$$\Sum{k}{0}{n} = \sum\limits_{|\frac{k}n - x| < \delta} + \sum\limits_{|\frac{k}n - x| \ge \delta}$$
Выберем $\delta$ так, чтобы первая сумма была меньше $\frac{\epsilon}2$. Это всегда можно сделать, так как функция $f(x)$ непрерывна, а 
$\sum\limits_{|\frac{k}n - x| < \delta}C_n^kx^k(1-x)^{n-k} \le 1$.
Во второй сумме ограничим модуль числом $M = 2\sup\limits_{[0,1]} f(x)$ (1-я теорема Вейерштрасса), а к оставшейся сумме применим неравенство Чебышева, поскольку она равна вероятности 
$\Pro(|\mu_n - nx| \ge n\delta)$. 
$$\sum\limits_{|\frac{k}n - x| \ge \delta}\ldots \le 2M\sum\limits_{|\frac{k}n - x| \ge \delta}C_n^kx^k(1-x)^{n-k} \le 2M\frac1{n\delta^2}$$
Выбором $n$ сделаем вторую сумму меньше $\frac{\epsilon}2$, доказав, тем самым, равномерную сходимость.
\end{Proof}

Пусть в схеме Бернулли с вероятностью успеха $0 < p \le 1$ величина $\eta$ равна номеру первого успеха. $\eta$ является случайной величиной, принимающей натуральные значения. Найдем распределение $\eta$: серия, в которой первый успех появляется в $k$-м испытании выглядит так: НН...НУ. Отсюда
$$\forall k \in \Nat \quad \Pro(\eta = k) = (1-p)^{k-1}p = q^{k-1}p $$
Так как $\Omega = \Set{\omega_k = \underbrace{0\ldots0}_k1}{k \in \Nat}$, то 
$$\Sum{k}{1}{n}\Pro(\omega_k) = \Sum{k}{1}{n} p(1-p)^{k-1} = 1$$
Такое распределение называется \underline{геометрическим с параметром $p$}.

Пусть $\xi$ имеет геометрическое распределение с параметром $p$. Тогда
$$\Expec\xi = \Sum{k}{1}{\infty}kp(1-p)^{k-1} = -p\Sum{k}{1}{\infty}\frac{d}{dp}(1-p)^k = -p \frac{d}{dp}(\frac{1-p}{p}) = \frac1{p}$$
Аналогично, дифференцирую степенные ряды, получим диспресию
$$\Disp\xi = \frac{q}{p^2}$$

Пусть теперь $\theta$ --- число неудач до $r$-го успеха. Тогда
$$\forall k \in\Int_0 \quad \Pro(\theta = k) = p^rq^kC_{k+r-1}^{k}$$
Это следует из того, что всего испытаний было $r+k$, на последнем месте успех, а до него как-то располагаются $k$ неудач и $r-1$ успех.
Такое распределение называется \underline{отрицательным биномиальным} с параметрами $r, p$.

\newpage


\end{document}
