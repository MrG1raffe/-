
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Chapters, Sections, Subsections
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

% Counter of section
\usepackage{chngcntr} % для counterwithin
\counterwithin*{section}{part}

% Section 
\usepackage{titlesec}
\titleformat{\section} {\normalfont\Large\bfseries\filcenter}{\S \!\ \thesection}{1em}{}
\titlespacing*{\subsection}{0pt}{3.5ex}{.3ex}

% Part
\titleformat
{\part} % command
[display] % shape
{\bfseries\Large\itshape} % format
{} % label
{0.5ex} % sep
{
    \rule{\textwidth}{2pt}
	\vspace{1cm}
    \centering
    Часть №\,\thepart. \;
} % before-code
[    
	\vspace{-1cm}
	\rule{\textwidth}{0.3pt}
] % after-code

% Change spacing after section
\usepackage[titles]{tocloft}
\renewcommand{\cftbeforesecskip}{3pt}

%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Title
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

% Для декораций
\usepackage{doc}
\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing,calligraphy,matrix}
\GetFileInfo{spath3.sty}

%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Table of Content
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

% Section
\usepackage{titletoc}
%\usepackage{titlesec}

\titlecontents{part}[0pt]{\normalsize\bfseries\protect\addvspace{15pt}}%
{}{\partname{} }%
{\enspace\titlerule\contentspage}%

\titlecontents{section}[2.4pc]
{\addvspace{0.4cm}}
{\contentslabel[\thecontentslabel]{2.4pc}}
{\S}
{\hfill\small \hspace{3cm}\thecontentspage}
[]


%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Background
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

\usepackage[pages=some]{background}
\usepackage{graphicx}
\usepackage{eso-pic}
\usepackage{transparent}
\AddToShipoutPictureBG{{\transparent{0.1}
  \begin{tikzpicture}[remember picture,overlay]
\node [xshift=0cm, yshift=0cm] at (current page.center) 
    {\includegraphics[width=\paperwidth]{back}};
\end{tikzpicture}}}
\backgroundsetup{
	scale=1,
	color=black,
	opacity=0.4,
	angle=0,
	contents={}%
}

%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Footers and headers and margins
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

% Отступы

\textheight=24cm
\textwidth=16cm
\oddsidemargin=0pt
\topmargin=-1.5cm
\parindent=24pt
\parskip=0pt
\tolerance=2000
\flushbottom

% Headers and footers

\usepackage{fancyhdr}
\usepackage{etoolbox}
\usepackage{lipsum} % just for the example

\pagestyle{fancy}
\fancypagestyle{main}{%
  \fancyhf{}%
  \fancyhead[C]{\rightmark}%
  \fancyfoot[C]{-\ \texttt{\thepage}\ -}%
  \renewcommand{\headrulewidth}{0.4pt}%
  \renewcommand{\footrulewidth}{0.4pt}%
}
\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyfoot[C]{}%
  \renewcommand{\headrulewidth}{0pt}%
  \renewcommand{\footrulewidth}{0pt}%
}

\appto\frontmatter{\pagestyle{plain}}
\appto\mainmatter{\pagestyle{main}}

%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Theorems and environments
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

% Theorems

\newtheorem{Th}{Теорема}[section]
\newtheorem{Def}[Th]{Определение}
\newtheorem{Lem}[Th]{Лемма}
\newtheorem{St}[Th]{Утверждение}

% Math Environments

\newenvironment{Proof}{\par\noindent{\bf Доказательство}}{$\blacksquare$} 
\newenvironment{Ex}{{\bf Пример}\ }{}

% Environments

\usepackage{graphicx}

\newenvironment{Wtf}{\includegraphics[height=5mm]{ping}}{}
\newenvironment{Why}{\includegraphics[height= 5mm]{cat}}{}
\newenvironment{Note}{\par\noindent{\bf Замечание}}{}

% For fancy enumerate
\usepackage{enumitem,pifont}

%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Math
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

% Packages

\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{amsmath}

\usepackage{bbm} % для индикатора

% Сокращения

\newcommand\xequiv[1]{\stackrel{\mathrm{ #1}}{\equiv}}
\newcommand\Set[2]{\left\{ #1 \colon #2 \right\}}
\newcommand\Sum[3]{\sum\limits_{#1 = #2}^{#3}}

\def\Pro{\mathbb{P}} % вероятность
\def\Ev{\mathscr{A}} % алгебра событий
\def\Bor{\mathscr{B}} % борелевская сигма-алгебра
\def\Real{\mathbb{R}} % вещественная прямая
\def\Int{\mathbb{Z}} % целые числа
\def\Nat{\mathbb{N}} % натуральные числа
\def\Compl{\mathbb{C}} % комплексные числа
\def\Expec{\mathbb{E}} % матожидание 
\def\Disp{\mathbb{D}}  % дисперсия
\def\Ind{\mathbbm{1}} % индикатор
\def\Med{{\rm med \,}} % медиана
\def\Cov{{\rm cov \,}} % ковыряция
\def\Mod{{\rm mod \,}} % мода
\def\Pois{{\rm Pois \,}} 
\def\Smpl{\mathbb{X}} 
\def\Norm{\mathcal{N}} % нормальное распределение


% Меняем нумерацию для уравнений
\numberwithin{equation}{section}


%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Fonts, text
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

%Font
\usepackage{libertine}

%Epigraph
\usepackage{epigraph}
\setlength\epigraphwidth{.6\textwidth}
\setlength\epigraphrule{0pt}

%Hyperref at table of content
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Subfiles
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

\usepackage{subfiles} % по-царски юзаем разбивку на файлы: 
% с возможностью компиляции каждого файла по отдельности и с автоматической преамбулой

\graphicspath{{pictures/}{../pictures/}} % один сработает для основного, 
% другой для subfiles

\DeclareGraphicsExtensions{.pdf,.png,.jpg}

%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------
% Others
%---------------------------------------------------------------------------------
%---------------------------------------------------------------------------------

% Additional packages

\usepackage{ulem} % нужен для \uline
\usepackage{cancel} %  зачеркивать
\usepackage{tikz} % рисуночки

% Это зачем? - науке неизвестно

\usepackage{pb-diagram}
\usepackage{pgfplots}
\usepackage{caption}
\usetikzlibrary{arrows,decorations.pathmorphing,backgrounds,positioning,fit,petri}
\usepgflibrary{arrows.meta}
\usetikzlibrary{arrows.meta}


